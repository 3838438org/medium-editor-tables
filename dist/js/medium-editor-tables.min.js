function MediumEditorTable(){"use strict";this.parent=!0,this.hasForm=!0,this.showGrid=!1,this.createButton()}"object"==typeof module?module.exports=MediumEditorTable:"function"==typeof define&&define.amd&&define(function(){"use strict";return MediumEditorTable}),function(a,b){"use strict";function c(a){var b=a.getSelection().anchorNode,c=b&&3===b.nodeType?b.parentNode:b;return c}function d(c,d){if(void 0!==a.getSelection&&c){var e=b.createRange(),f=a.getSelection();d?e.setStartBefore(c):e.setStartAfter(c),e.collapse(!0),f.removeAllRanges(),f.addRange(e)}}function e(a){if(!a)return!1;for(var b=a.parentNode,c=b.tagName.toLowerCase();"body"!==c;){if("table"===c)return!0;if(b=b.parentNode,!b||!b.tagName)return!1;c=b.tagName.toLowerCase()}return!1}function f(a,b){var c=a&&a.tagName?a.tagName.toLowerCase():!1;if(!c)return!1;for(;c&&"body"!==c;){if(c===b)return a;a=a.parentNode,c=a&&a.tagName?a.tagName.toLowerCase():!1}}function g(a,b,c){return--b.cells.length==a.cellIndex&&--c.rows.length==b.rowIndex}function h(a){return a=a.previousSibling,a?a.cells[a.cells.length-1]:void 0}MediumEditorTable.prototype={createButton:function(){this.button=b.createElement("button"),this.button.className="medium-editor-action",this.button.innerHTML="tbl",this.button.addEventListener("click",function(a){a.preventDefault(),this.clickHandler()}.bind(this))},clickHandler:function(){this.showGrid===!0?this.hide():this.show()},hide:function(){this.showGrid=!1,this.tableBuilderElement.style.display="",this.button.classList.remove("medium-editor-button-active")},show:function(){this.showGrid=!0,this.tableBuilderElement.style.display="block",this.tableBuilderElement.style.left=this.button.offsetLeft+"px",this.button.classList.add("medium-editor-button-active")},getForm:function(){return this.tableBuilderElement||this.createTableBuilder(),this.tableBuilderElement},createTableBuilder:function(){this.tableBuilderElement=this.base.options.ownerDocument.createElement("div"),this.tableBuilderElement.className="medium-editor-table-builder",this.renderGrid(),this.bind()},generateCells:function(){this.cells=[];for(var a=0;100>a;a++){var b=a%10,c=Math.floor(a/10);this.cells.push({col:b,row:c,active:!1})}},getGridHTML:function(){var a='<div class="medium-editor-table-builder-grid clearfix">';return a+=this.getCellsHTML(),a+="</div>"},getCellsHTML:function(){var a="";return this.generateCells(),this.cells.map(function(b){a+='<a href="#" class="medium-editor-table-builder-cell'+(b.active===!0?" active":"")+'" data-row="'+b.row+'" data-col="'+b.col+'">',a+="</a>"}),a},renderGrid:function(){this.tableBuilderElement.innerHTML=this.getGridHTML(),this.cellsElements=this.tableBuilderElement.querySelectorAll("a")},onHide:function(){this.hide(),this.hoveredCell={col:-1,row:-1},this.markCells()},getButton:function(){return"fontawesome"===this.base.options.buttonLabels&&(this.button.innerHTML='<i class="fa fa-table"></i>'),this.button},bind:function(){[].forEach.call(this.cellsElements,function(a){this.bindMouseEnter(a),this.bindClick(a)}.bind(this)),this.bindTabOnTables()},bindMouseEnter:function(a){var b,c=this;a.addEventListener("mouseenter",function(){clearTimeout(b);var a=this.dataset;b=setTimeout(function(){c.hoveredCell={col:parseInt(a.col,10),row:parseInt(a.row,10)},console.log(c.hoveredCell),c.markCells()},10)})},bindClick:function(a){var b=this;a.addEventListener("click",function(a){a.preventDefault(),b.insertTable(this.dataset.col,this.dataset.row)})},markCells:function(){var a=this;[].forEach.call(this.cellsElements,function(b){var c={col:parseInt(b.dataset.col,10),row:parseInt(b.dataset.row,10)},d=a.hoveredCell&&c.row<=a.hoveredCell.row&&c.col<=a.hoveredCell.col;d===!0?b.classList.add("active"):b.classList.remove("active")})},insertTable:function(a,b){var c,e,f="";for(e=0;b>=e;e++){for(f+="<tr>",c=0;a>=c;c++)f+="<td><br /></td>";f+="</tr>"}this.base.insertHTML('<table class="medium-editor-table" id="medium-editor-table"><tbody>'+f+"</tbody></table><p><br /></p>");var g=this.base.options.ownerDocument.getElementById("medium-editor-table");g.removeAttribute("id"),d(g.querySelector("td"),!0)},bindTabOnTables:function(){var a=this;[].forEach.call(this.base.elements,function(b){b.addEventListener("keydown",function(b){var i=c(a.base.options.ownerDocument),j=j,k=k;9===b.which&&e(i)&&(b.preventDefault(),b.stopPropagation(),i=f(i,"td"),j=f(i,"tr"),k=f(i,"table"),b.shiftKey?d(i.previousSibling||h(j),!0):(g(i,j,k)&&a.insertRow(f(i,"tbody"),j.cells.length),d(i)))})})},insertRow:function(a,c){var d,e=b.createElement("tr"),f="";for(d=0;c>d;d+=1)f+="<td><br /></td>";e.innerHTML=f,a.appendChild(e)}}}(window,document);